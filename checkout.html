<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout – Custom Phone Cases</title>

  <!-- Keep your existing CSS -->
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/realtime-updates.css">

  <style>
    .container { max-width: 800px; margin: 0 auto; padding: 20px; }
    h1, h2 { text-align: center; }
    .form-section { margin-bottom: 24px; }
    label { display: block; margin: 8px 0 4px; font-weight: 600; }
    input, select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
    .summary-line { display: flex; justify-content: space-between; margin: 6px 0; font-size: 15px; }
    .total-line { font-weight: bold; font-size: 18px; border-top: 1px solid #eee; padding-top: 8px; }
    button { cursor: pointer; font-weight: 600; border-radius: 6px; padding: 12px; width: 100%; margin-top: 12px; }
    #verify-btn { background:#ffc107; color:#212529; }
    #pay-btn    { background:#007bff; color:#fff; display:none; }
    .error-message { color:#dc3545; margin:12px 0; display:none; }
    .gift-option { background:#f8fbff; padding:16px; border:2px solid #e6f2ff; border-radius:8px; margin:16px 0; }
    .gift-option label { display:flex; align-items:center; cursor:pointer; margin:0; }
    .gift-option input { width:18px; height:18px; margin-right:12px; }
  </style>
</head>
<body>
  <div class="container">

    <div style="text-align:center; margin:20px 0;">
      <img src="logo.png" alt="Logo" style="height:60px;">
    </div>

    <h1>Checkout</h1>

    <!-- Cart preview -->
    <div id="cart-items-container" style="margin-bottom:20px;"></div>

    <!-- Gift option -->
    <div class="gift-option">
      <label>
        <input type="checkbox" id="gift-checkbox">
        <div>
          <div style="font-weight:600; color:#0056b3;">Send as a gift</div>
          <div style="color:#666; font-size:13px;">We'll wrap it beautifully and ship directly to your recipient</div>
          <div style="color:#d4af37; font-weight:600; font-size:13px; margin-top:6px;">+ $12.00 gift service</div>
        </div>
      </label>
    </div>

    <!-- Shipping address -->
    <div class="form-section">
      <h2 id="shipping-title">Shipping Address</h2>
      <form id="shipping-form">
        <label>First name <input id="ship_first" required></label>
        <label>Last name  <input id="ship_last"  required></label>
        <label>Address line 1 <input id="ship_addr1" required></label>
        <label>Address line 2 <input id="ship_addr2"></label>
        <label>City <input id="ship_city" required></label>
        <label>State
          <select id="ship_state" required>
            <option value="">-- Select --</option>
            <!-- 50 US states – keep the same list you used in case.html -->
            <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option>
            <option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option>
            <option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option>
            <option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option>
            <option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option>
            <option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option>
            <option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option>
            <option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option>
            <option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option>
            <option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option>
            <option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option>
            <option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option>
            <option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option>
            <option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option>
            <option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option>
            <option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option>
            <option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
          </select>
        </label>
        <label>ZIP code <input id="ship_zip" required pattern="\d{5}(-\d{4})?"></label>
      </form>
    </div>

    <!-- Same-billing toggle -->
    <div class="form-section">
      <label style="display:flex; align-items:center;">
        <input type="checkbox" id="same-billing" checked>
        <span style="margin-left:8px;">Billing address same as shipping</span>
      </label>
    </div>

    <!-- Billing address (hidden by default) -->
    <div id="billing-form" class="form-section" style="display:none;">
      <h2>Billing Address</h2>
      <label>First name <input id="bill_first" required></label>
      <label>Last name  <input id="bill_last"  required></label>
      <label>Address line 1 <input id="bill_addr1" required></label>
      <label>Address line 2 <input id="bill_addr2"></label>
      <label>City <input id="bill_city" required></label>
      <label>State
        <select id="bill_state" required>
          <option value="">-- Select --</option>
          <!-- same 50-state list as above -->
          <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option>
          <option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option>
          <option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option>
          <option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option>
          <option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option>
          <option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option>
          <option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option>
          <option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option>
          <option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option>
          <option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option>
          <option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option>
          <option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option>
          <option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option>
          <option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option>
          <option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option>
          <option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option>
          <option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
        </select>
      </label>
      <label>ZIP code <input id="bill_zip" required pattern="\d{5}(-\d{4})?"></label>
    </div>

    <!-- Order summary -->
    <div class="form-section">
      <h2>Order Summary</h2>
      <div class="summary-line"><span>Subtotal:</span><span>$<span id="subtotal">0.00</span></span></div>
      <div id="gift-fee-line" class="summary-line" style="display:none;"><span>Gift service:</span><span style="color:#d4af37;">$12.00</span></div>
      <div id="tax-line" class="summary-line" style="display:none;"><span>Sales tax:</span><span>$<span id="tax-amount">0.00</span></span></div>
      <div class="summary-line total-line"><span>Total:</span><span style="color:#2c5530;">$<span id="total">0.00</span></span></div>
    </div>

    <div id="error-message" class="error-message"></div>

    <button id="verify-btn">Verify Address & Calculate Total</button>
    <button id="pay-btn">Proceed to Payment (Stripe)</button>

  </div>

  <!-- Scripts – keep the exact order you already use -->
  <script src="config/constants.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/device-manager.js"></script>
  <script src="js/promo-manager.js"></script>
  <script src="js/upload-manager.js"></script>

  <!-- NEW: checkout manager (handles everything on this page) -->
  <script src="js/checkout-manager.js"></script>

  <script src="https://js.stripe.com/v3/"></script>
  <script src="js/stripe-payment.js"></script>
  <script src="js/websocket-manager.js"></script>
  <script src="js/progress-tracker.js"></script>
  <script src="js/ui-components-manager.js"></script>
  <script src="js/image-navigation-handler.js"></script>
  <script src="js/realtime-updates.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
